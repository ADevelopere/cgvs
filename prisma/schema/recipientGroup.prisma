model RecipientGroupItemVariableValue {
  id                           Int                         @id @default(autoincrement())
  templateRecipientGroupItemId Int
  templateVariableId           Int
  value                        String?
  valueIndexed                 String?                     @db.VarChar(255)
  createdAt                    DateTime
  updatedAt                    DateTime
  templateRecipientGroupItem   TemplateRecipientGroupItem @relation(fields: [templateRecipientGroupItemId], references: [id])
  templateVariable             TemplateVariableBase        @relation(fields: [templateVariableId], references: [id])

  @@unique([templateRecipientGroupItemId, templateVariableId], name: "rgiv_group_item_variable_unique")
  @@index([valueIndexed], name: "rgiv_value_idx")
}

model TemplateRecipientGroupItem {
  variableValues           RecipientGroupItemVariableValue[]
  id                       Int                               @id @default(autoincrement())
  templateRecipientGroupId Int
  studentId                Int
  createdAt                DateTime
  updatedAt                DateTime
  templateRecipientGroup   TemplateRecipientGroup            @relation(fields: [templateRecipientGroupId], references: [id])
  student                  Student                           @relation(fields: [studentId], references: [id])

  @@unique([studentId, templateRecipientGroupId], name: "trgi_student_group_unique")
}

model TemplateRecipientGroup {
  items        TemplateRecipientGroupItem[]
  certificates Certificate[]
  id           Int                          @id @default(autoincrement())
  templateId   Int
  template     Template                     @relation(fields: [templateId], references: [id])
  name         String                       @db.VarChar(255)
  description  String?
  date         DateTime?
  createdAt    DateTime
  updatedAt    DateTime
}
